{% extends "base.html" %}

{% block title %}{{ constellation.constellation_name }} - 星座详情{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>{{ constellation.constellation_name }} 详情</h2>
    <div>
        <a href="{{ url_for('satellite.add') }}" class="btn btn-success">添加卫星</a>
        <a href="{{ url_for('constellation.edit', id=constellation.id) }}" class="btn btn-primary">编辑星座</a>
        <a href="{{ url_for('constellation.list') }}" class="btn btn-outline-secondary">返回列表</a>
    </div>
</div>

<!-- 星座基本信息 -->
<div class="card shadow mb-4">
    <div class="card-header bg-light">
        <h5 class="mb-0">星座信息</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>星座名称：</strong>{{ constellation.constellation_name }}</p>
                <p><strong>当前卫星数量：</strong>{{ constellation.satellite_count }}</p>
            </div>
        </div>
    </div>
</div>

<!-- 卫星列表展示 -->
<div class="satellite-list">
  <h3>卫星列表（共 {{ pagination.total }} 颗）</h3>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>卫星ID</th>
        <th>信息1</th>
        <th>信息2</th>
      </tr>
    </thead>
    <tbody>
      {% for satellite in satellites %}
      <tr>
        <td>{{ satellite.satellite_id }}</td>
        <td>{{ satellite.info_line1 }}</td>
        <td>{{ satellite.info_line2 }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="3" class="text-center">暂无卫星数据</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- 分页导航 -->
{% if pagination.pages > 1 %}  <!-- 只有多页时才显示分页 -->
<nav class="pagination-nav" aria-label="卫星分页">
  <ul class="pagination justify-content-center">
    <!-- 上一页 -->
    <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for('constellation.detail', id=constellation.id, page=pagination.prev_num) if pagination.has_prev else '#' }}">
        上一页
      </a>
    </li>

    <!-- 页码列表（只显示当前页前后2页，避免页码过多） -->
    {% for page_num in pagination.iter_pages(left_edge=1, left_current=2, right_current=2, right_edge=1) %}
      {% if page_num %}
        <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
          <a class="page-link" href="{{ url_for('constellation.detail', id=constellation.id, page=page_num) }}">
            {{ page_num }}
          </a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">...</span></li>
      {% endif %}
    {% endfor %}

    <!-- 下一页 -->
    <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for('constellation.detail', id=constellation.id, page=pagination.next_num) if pagination.has_next else '#' }}">
        下一页
      </a>
    </li>
  </ul>
</nav>
{% endif %}
<div class="mb-3">
    <a href="{{ url_for('constellation.import_satellites', constellation_id=constellation.id) }}" class="btn btn-success">
        导入卫星数据
    </a>
    <a href="{{ url_for('satellite.import_links', constellation_id=constellation.id) }}" class="btn btn-info ms-2">
        导入卫星关联
    </a>
</div>
{% endblock %}